<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Migrating Cloud Foundry applications to IBM Kubernetes Services :: Cloudnative Learning 101</title>
    <link rel="canonical" href="https://ibm-cloud-architecture.github.io/cloudnative-learning-101/cloudnative-learning-101/1.0.0/CF_Migrate_Module/cf-migrate-exercise-iks.html">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <p>Cloudnative Learning 101</p>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="cloudnative-learning-101" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Cloudnative Learning 101</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Cloud Native Module</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Cloud_Native_Module/Cloudnative_Overview.html">Cloudnative Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Cloud_Native_Module/Cloudnative_framework_prog_model.html">Cloudnative Framework &amp; Programming Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Cloud_Native_Module/Cloudnative_app_development.html">Cloud Native App Development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Cloud_Native_Module/Lab1.html">Lab 1: Cloudnative App Development</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Kubernetes Module</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kubernetes_Module/Docker.html">Containerization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kubernetes_Module/Lab2.html">Lab 2: Docker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kubernetes_Module/kubernetesPatterns.html">Kubernetes Patterns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kubernetes_Module/Lab3.html">Lab 3: Kubernetes Patterns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kubernetes_Module/Lab4.html">Lab 4: Deploy the app on Kube</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kubernetes_Module/operators.html">Helm/Operator Patterns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Kubernetes_Module/Lab5.html">Lab 5: Deploy the app on Kube using Helm (TODO)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Cloud Foundry Migration Module</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Kubernetes-for-CF.html">Kubernetes for Cloud Foundry users</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="CF-migration.html">CF Migration Tool</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/ibm-cloud-architecture/cf-transformation/blob/master/exercise/openshift.md">Lab 7: Migrate your app from CF to Kube (Openshift) - Github Link</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/ibm-cloud-architecture/cf-transformation/blob/master/exercise/iks.md">Lab 7: Migrate your app from CF to Kube (IKS) - Github link</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">DevOps Module</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DevOps_Module/Devops_Concepts.html">DevOps Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DevOps_Module/cicd.html">CI/CD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DevOps_Module/devops_tooling.html">Devops Tooling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DevOps_Module/Lab8_Openshift.html">Lab 8: CI - Openshift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DevOps_Module/Lab8_IKS.html">Lab 8: CI - IKS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DevOps_Module/Lab9_OpenShift.html">Lab 9: CD - Openshift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../DevOps_Module/Lab9_IKS.html">Lab 9: CD - IKS</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Cloudnative Learning 101</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Cloudnative Learning 101</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Cloudnative Learning 101</a></li>
    <li><a href="cf-migrate-exercise-iks.html">Migrating Cloud Foundry applications to IBM Kubernetes Services</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///root/project/modules/ROOT/pages/CF_Migrate_Module/cf-migrate-exercise-iks.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1 class="page">Migrating Cloud Foundry applications to IBM Kubernetes Services</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_liberty_hello_world_application_accessed_from_downloaded_exemplar_sub_directory">Liberty hello-world application accessed from downloaded <code>exemplar</code> sub-directory</a>
<ul class="sectlevel2">
<li><a href="#_preparing_the_migration_environment">Preparing the migration environment</a></li>
<li><a href="#_testing_the_application_on_the_cloud_foundry_environment">Testing the application on the Cloud Foundry environment</a></li>
<li><a href="#_running_the_migration_tool_and_deploying_the_application_to_ibm_kubernetes_services">Running the migration tool and deploying the application to IBM Kubernetes Services</a></li>
</ul>
</li>
<li><a href="#_liberty_hello_world_application_accessed_from_a_git_repository">Liberty hello-world application accessed from a Git repository</a></li>
<li><a href="#_springboot_application_jar_file_accessed_from_a_git_repository">SpringBoot application (jar file) accessed from a Git repository</a></li>
<li><a href="#_node_js_application_accessed_from_a_git_repository">Node.js application accessed from a Git repository</a></li>
<li><a href="#_node_js_application_with_a_cloudant_database_backend_service">Node.js application with a Cloudant database backend service</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This exercise describes using the migration tool to migrate each of the following example applications to IBM Kubernetes Services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Liberty hello-world application accessed from downloaded <code>exemplar</code> sub-directory</p>
</li>
<li>
<p>Liberty hello-world application accessed from a Git repository</p>
</li>
<li>
<p>SpringBoot application (jar file) accessed from a Git repository</p>
</li>
<li>
<p>Node.js application accessed from a Git repository</p>
</li>
<li>
<p>Node.js application with a Cloudant database backend service</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The migration tool is run from a Docker container. The migration tool Docker container is provided so you can run the tool without having to install all the prerequisite software on your own system.</p>
</div>
<div class="paragraph">
<p>In the beginning of the exercise, you deploy the application to a CloudFoundry platform. The instructions use the IBM Cloud Public Cloud Foundry platform for convenience, but the tool is designed to work with Pivotal or any other Cloud Foundry platform.</p>
</div>
<div class="paragraph">
<p>The applications are deployed to Cloud Foundry for two purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To validate that the application <strong>does</strong> run in CloudFoundry</p>
</li>
<li>
<p>To extract the credentials for any backend services used by the Cloud Foundry application in the VCAP_SERVICES environment variable. As part of the migration, these credentials are used to create Kubernetes secrets, to allow the same backend services to be accessed by the application running on the target Kubernetes platform (OpenShift, IBM Kubernetes Service, or IBM Cloud Public).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You should be able to use any application that can be deployed to Cloud Foundry to do these exercises. By running through the steps with the example applications provided here, you will acquire the skills to use the tool with other applications running on Cloud Foundry.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_liberty_hello_world_application_accessed_from_downloaded_exemplar_sub_directory"><a class="anchor" href="#_liberty_hello_world_application_accessed_from_downloaded_exemplar_sub_directory"></a>Liberty hello-world application accessed from downloaded <code>exemplar</code> sub-directory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this first case, you migrate an application that runs on WebSphere Liberty in Cloud Foundry. This application has a dependency on several custom user-provided services. The migration task is divided into several stages which are listed below.</p>
</div>
<div class="sect2">
<h3 id="_preparing_the_migration_environment"><a class="anchor" href="#_preparing_the_migration_environment"></a>Preparing the migration environment</h3>
<div class="paragraph">
<p>You run these preparation steps only once. There is no need to redo these steps for subsequent lab exercises:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the provided docker image. You should have Docker installed and running on your system. Provide an empty local directory path to be used as the conversion working directory. The following command connects you to a bash shell inside the migration tool container.</p>
<div class="literalblock">
<div class="content">
<pre>docker run -v &lt;your_local_path&gt;:/data -v /var/run/docker.sock:/var/run/docker.sock -it ibmcloudacademy/cfmigrationtool bash</pre>
</div>
</div>
</li>
<li>
<p>From the bash shell of the docker container, clone the repository containing the migration tool and sample application code:</p>
<div class="literalblock">
<div class="content">
<pre>git clone https://github.com/ibm-cloud-architecture/cf-transformation</pre>
</div>
</div>
<div class="paragraph">
<p>The result is that you have a <code>/cf-transformation</code> directory that contains the conversion code.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_testing_the_application_on_the_cloud_foundry_environment"><a class="anchor" href="#_testing_the_application_on_the_cloud_foundry_environment"></a>Testing the application on the Cloud Foundry environment</h3>
<div class="paragraph">
<p>As mentioned at the beginning of the exercise, you deploy the application to Cloud Foundry. This stage verifies that the application is valid and allows you to collect the proper VCAP_SERVICES environment variable for the application. The binding of backend services to the application in Cloud Foundry is typically performed by referencing the VCAP_SERVICES variable.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the example application code directory:</p>
<div class="literalblock">
<div class="content">
<pre>cd cf-transformation/exemplar/hello-world</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/001-docker.png" alt="001 docker">
</div>
</div>
</li>
<li>
<p>Login and deploy the application to Cloud Foundry in IBM Cloud Public.</p>
<div class="ulist">
<ul>
<li>
<p>You will be prompted for your user id, password, and region for login</p>
</li>
<li>
<p>You should substitute your first and last name for the User Provided Service values</p>
</li>
<li>
<p>Substitute your initials for the <code>abc</code> in the <code>ibmcloud app push</code> command. Your application name and route must be unique.</p>
<div class="literalblock">
<div class="content">
<pre>ibmcloud login
ibmcloud target --cf</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/002-cflogin.png" alt="002 cflogin">
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn clean install
ibmcloud cf cups ups1 -p '{ "key1": "First " }'
ibmcloud cf cups ups2 -p '{ "key2": "Lastname" }'
ibmcloud cf cups ups3 -p '{ "key3": "value3" }'
ibmcloud app push abc-hello-world -n abc-hello-world</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/003-cups.png" alt="003 cups">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/003-cfpush.png" alt="003 cfpush">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Test your application to see whether it is running on Cloud Foundry. Go to the URL <code><a href="http://abc-hello-world.mybluemix.net" class="bare">http://abc-hello-world.mybluemix.net</a></code>, substituting your initials for <code>abc</code>. You should see the following screen, with your name displayed:</p>
<div class="imageblock">
<div class="content">
<img src="../_images/004-sampleapp.png" alt="004 sampleapp">
</div>
</div>
</li>
<li>
<p>Now that the application is running, you should see that it is getting the values for your first and last name from the Custom User Provided Services (cups) you created and populated in the previous commands.</p>
</li>
<li>
<p>Go to the migration tool path:</p>
<div class="literalblock">
<div class="content">
<pre>cd /cf-transformation/migrate</pre>
</div>
</div>
</li>
<li>
<p>Retrieve the application&#8217;s VCAP_SERVICES variables and put them in the <code>vcap.json</code> file.</p>
<div class="literalblock">
<div class="content">
<pre>ibmcloud cf env abc-hello-world | awk '/VCAP_SERVICES/{flag=1} /^}/{flag=0} flag' | sed 's/"VCAP_SERVICES"://' &gt; vcap.json
cat vcap.json</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_migration_tool_and_deploying_the_application_to_ibm_kubernetes_services"><a class="anchor" href="#_running_the_migration_tool_and_deploying_the_application_to_ibm_kubernetes_services"></a>Running the migration tool and deploying the application to IBM Kubernetes Services</h3>
<div class="paragraph">
<p>The last stage of the migration is performed for the specific target environment.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the migration command:</p>
<div class="literalblock">
<div class="content">
<pre>./cf-migrate.sh -s /cf-transformation/exemplar/hello-world -t /data/cfliberty1 -e iks -b ibm-websphere-liberty</pre>
</div>
</div>
<div class="paragraph">
<p>The output should be similar to the following:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/006-convert.png" alt="006 convert">
</div>
</div>
</li>
<li>
<p>Open the generated <code>result.html</code> file using a Web browser (remember the path mapping that you did in the first step of preparing the environment). The <code>result.html</code> file will be in the subdirectory <code>cfliberty1/hello-world/defaultServer</code>.
image::007-result.png[]</p>
</li>
<li>
<p>Go directly to the section <strong>Deploying application to IBM Kubernetes Services</strong> and perform the step-by-step instructions there. Note that you must specify the following values:</p>
<div class="ulist">
<ul>
<li>
<p>Repository host (REPOHOST). You can use <code>docker.io</code> to use DockerHub or use <code>icr.io</code> for IBM Cloud registry.</p>
</li>
<li>
<p>Namespace (REPOSPACE). Your namespace (in DockerHub, it is similar to your userID) that you define in the repository.</p>
</li>
<li>
<p>Kubernetes cluster name (CLUSTER)</p>
<div class="paragraph">
<p>Note that for login to the IBM Kubernetes Services cluster using the <code>ibmcloud login</code> command, you may be asked to get an SSO login token. The commands that are listed in steps 2 and later are using the environment variables that are set above. If you have defined these environment variables, you should be able to run the commands as-is, directly cut-and-pasted from the <code>result.html</code> browser page to the bash prompt of the cfmigrationtool container.</p>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/007-1-output.png" alt="007 1 output">
</div>
</div>
<div class="paragraph">
<p>+
image::007-2-output.png[]</p>
</div>
<div class="paragraph">
<p>+
image::007-3-output.png[]</p>
</div>
</li>
<li>
<p>Once the migration is completed, depending on the Kubernetes cluster type (Free or Paid cluster), collect the target route as follows (you must do the same thing for each of the other scenarios below):</p>
<div class="ulist">
<ul>
<li>
<p>For free cluster, use the Worker Node public IP and NodePort, run <code>ibmcloud ks workers --cluster $CLUSTER</code> and <code>kubectl get service</code></p>
</li>
<li>
<p>For a paid cluster, the target route should be: <code>&lt;APPLNAME&gt;.&lt;CLUSTER&gt;.&lt;REGION&gt;.containers.appdomain.cloud</code></p>
<div class="paragraph">
<p>Open a browser window to <code><a href="https://&lt;routehost&gt;/JavaHelloWorldApp" class="bare">https://&lt;routehost&gt;/JavaHelloWorldApp</a></code>. The result should be similar to the one you had for the application on Cloud Foundry.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/008-sampleapp.png" alt="008 sampleapp">
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_liberty_hello_world_application_accessed_from_a_git_repository"><a class="anchor" href="#_liberty_hello_world_application_accessed_from_a_git_repository"></a>Liberty hello-world application accessed from a Git repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this second test case, you will migrate content that is retrieved directly from a git repository. This sample application does not use any backend services, hence you do not need to collect the VCAP_SERVICES values. The steps listed here can be performed directly similar to the previous exercise.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go back to the <code>migrate</code> directory and run the following command:</p>
<div class="literalblock">
<div class="content">
<pre>cd /cf-transformation/migrate
./cf-migrate.sh -s https://github.com/IBM-Cloud/java-helloworld -t /data/cfliberty2 -e iks -b ibm-websphere-liberty</pre>
</div>
</div>
</li>
<li>
<p>Open the <code>result.html</code> file in subdirectory <code>cfliberty2/hello-world/defaultServer</code> in a Web browser and follow the instructions similar to the first test case. Check whether the application has launched and can be accessed on IBM Kubernetes Services. Check the URL <code><a href="https://&lt;routehost&gt;/JavaHelloWorldApp" class="bare">https://&lt;routehost&gt;/JavaHelloWorldApp</a></code>.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/liberty2.png" alt="liberty2">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_springboot_application_jar_file_accessed_from_a_git_repository"><a class="anchor" href="#_springboot_application_jar_file_accessed_from_a_git_repository"></a>SpringBoot application (jar file) accessed from a Git repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this third test case, you will migrate a SpringBoot REST application from a git repository. This sample application does not use any backend services, hence you do not need to collect the VCAP_SERVICES values. The steps listed here can be performed directly similar to the first exercise.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go back to the <code>migrate</code> directory and run the following command:</p>
<div class="literalblock">
<div class="content">
<pre>cd /cf-transformation/migrate
./cf-migrate.sh -s https://github.com/ibm-cloud-academy/lightblue-customer -t /data/cfjava -e iks -b java</pre>
</div>
</div>
</li>
<li>
<p>Open the <code>result.html</code> file in subdirectory <code>cfjava/target</code> in a Web browser and follow the instructions similar to the first test case. Check whether the application has launched and can be accessed on IBM Kubernetes Services. Check the URL <code><a href="https://&lt;routehost&gt;/customer" class="bare">https://&lt;routehost&gt;/customer</a></code>.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/customer.png" alt="customer">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_node_js_application_accessed_from_a_git_repository"><a class="anchor" href="#_node_js_application_accessed_from_a_git_repository"></a>Node.js application accessed from a Git repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this fourth test case, you will migrate a Node.js application from a git repository. This sample application does not use any backend services, hence you do not need to collect the VCAP_SERVICES values. The steps listed here can be performed directly similar to the first exercise.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go back to the <code>migrate</code> directory and run the following command:</p>
<div class="literalblock">
<div class="content">
<pre>cd /cf-transformation/migrate
./cf-migrate.sh -s https://github.com/IBM-Cloud/node-helloworld -t /data/cfnodejs -e iks -b nodejs</pre>
</div>
</div>
</li>
<li>
<p>Open the <code>result.html</code> file in subdirectory <code>cfnodejs/node-helloworld</code> in a Web browser and follow the instructions similar to the first test case. Check whether the application has launched and can be accessed on IBM Kubernetes Services. Check the URL <code><a href="https://&lt;routehost&gt;/" class="bare">https://&lt;routehost&gt;/</a></code>.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/nodehello.png" alt="nodehello">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_node_js_application_with_a_cloudant_database_backend_service"><a class="anchor" href="#_node_js_application_with_a_cloudant_database_backend_service"></a>Node.js application with a Cloudant database backend service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this last test case, we demonstrate another example that uses a backend service. This sample application uses a Cloudant database. Therefore in this case you will deploy the application to Cloud Foundry first so you can collect the VCAP_SERVICES information.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the application, and deploy the Cloudant database backend service and the application. Assuming you are still logged on to IBM Cloud Public, the following commands are used.</p>
<div class="literalblock">
<div class="content">
<pre>git clone https://github.com/IBM-Cloud/nodejs-cloudant.git
cd nodejs-cloudant
ibmcloud service create cloudantNoSQLDB Lite sample-nodejs-cloudant-cloudantNoSQLDB
ibmcloud service list</pre>
</div>
</div>
<div class="paragraph">
<p>Keep running the <code>ibmcloud service list</code> command until the <code>last operation</code> of the Cloudant service returns as <code>create succeeded</code>. Then continue with the following command.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ibmcloud app push</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The application and its Cloudant service will be deployed automatically. The route is shown at the end of the deployment.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/deploycld.png" alt="deploycld">
</div>
</div>
</li>
<li>
<p>Open the application and try uploading any file from your local system to the organizer application. Use <strong>Choose file</strong> and then <strong>Upload</strong>. This action is needed to demonstrate that the migrated application is using the same Cloudant backend service from IBM Kubernetes Services.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/organizer.png" alt="organizer">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Extract the VCAP_SERVICES:</p>
<div class="literalblock">
<div class="content">
<pre>cd /cf-transformation/migrate
ibmcloud cf env sample-nodejs-cloudant | awk '/VCAP_SERVICES/{flag=1} /^}/{flag=0} flag' | sed 's/"VCAP_SERVICES"://' &gt; vcap.json</pre>
</div>
</div>
</li>
<li>
<p>Run the migration tool:</p>
<div class="literalblock">
<div class="content">
<pre>./cf-migrate.sh -s https://github.com/IBM-Cloud/nodejs-cloudant -t /data/cfnodecloudant -e iks -b nodejs</pre>
</div>
</div>
</li>
<li>
<p>Open the <code>result.html</code> file in subdirectory <code>cfnodecloudant/nodejs-cloudant</code> in a Web browser and follow the instructions similar to the first test case. Check whether the application has launched and can be accessed on IBM Kubernetes Services. Check the URL <code><a href="https://&lt;routehost&gt;/" class="bare">https://&lt;routehost&gt;/</a></code>. Make sure that the file that you uploaded in step 1 on Cloud Foundry exists and is displayed from the database.</p>
</li>
</ol>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
